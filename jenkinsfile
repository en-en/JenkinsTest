node() {

    stage('pull') {
        echo "拉取代码"
           checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: '303325d0-e6fd-40dc-9a5f-4fbeab6a0c4b', url: 'https://github.com/en-en/JenkinsTest.git']]])
   
   docker_img_name="jenkinstest"
    }


    stage('Test') {
        echo "2.Test Stage"
    }
    stage('Build') {
        echo "3.Build Docker Image Stage"
        sh "docker build -t ${docker_img_name} ."
    }

    stage('Push') {
        echo "4.Deploy jar and Push Docker Image Stage"
        
        sh "docker login -u admin -p Harbor12345 39.104.110.227"
        sh "docker push 39.104.110.227/jenkinstest/${docker_img_name}:${tag} ."
    }

    //stash 'complete-build'
}

